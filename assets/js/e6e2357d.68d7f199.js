"use strict";(globalThis.webpackChunkbook_ui=globalThis.webpackChunkbook_ui||[]).push([[506],{7897:(e,s,t)=>{t.r(s),t.d(s,{default:()=>o});var i=t(6540),r=t(9211),a=t(9345),n=t(6347),l=t(4848);const o=()=>{const{user:e,isAuthenticated:s,logout:t,token:o,isInitialized:d,updateUserProfile:c}=(0,a.A)(),m=(0,n.W6)(),[h,x]=(0,i.useState)({}),[p,g]=(0,i.useState)(!0),[u,b]=(0,i.useState)(!1),[j,f]=(0,i.useState)(!1),[y,v]=(0,i.useState)(null),[N,_]=(0,i.useState)(!1),[k,w]=(0,i.useState)({first_name:"",last_name:""});(0,i.useEffect)(()=>{e&&w({first_name:e.first_name||"",last_name:e.last_name||""})},[e]);const S="undefined"!=typeof window?localStorage.getItem("token")||localStorage.getItem("access_token"):null;(0,i.useEffect)(()=>{d&&s&&e?C():!d||s||S||g(!1)},[d,s,e,o]);const C=async()=>{try{const e=o||S;if(!e)return;const s=await fetch("http://localhost:8000/api/v1/auth/reading-progress",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(s.ok){const e=await s.json();x(e.reading_progress||{})}}catch(e){console.error("Failed to fetch reading progress:",e)}finally{g(!1)}},P=e=>{const{name:s,value:t}=e.target;w(e=>({...e,[s]:t})),v(null)};if(!d||S&&!e)return(0,l.jsx)(r.A,{title:"Profile",description:"User profile page",children:(0,l.jsx)("div",{className:"container margin-vert--lg",children:(0,l.jsx)("div",{className:"row",children:(0,l.jsx)("div",{className:"col col--6 col--offset-3",children:(0,l.jsxs)("div",{className:"card",style:{textAlign:"center",padding:"50px"},children:[(0,l.jsxs)("div",{className:"card__body",children:[(0,l.jsx)("div",{className:"spinner",style:{border:"4px solid #f3f3f3",borderTop:"4px solid #7e22ce",borderRadius:"50%",width:"40px",height:"40px",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),(0,l.jsx)("h3",{children:"Loading Profile..."}),(0,l.jsx)("p",{children:"Please wait while we retrieve your account details."})]}),(0,l.jsx)("style",{children:"@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }"})]})})})})});if(!s&&!e&&!S)return(0,l.jsx)(r.A,{title:"Profile",description:"User profile page",children:(0,l.jsx)("div",{className:"container margin-vert--lg",children:(0,l.jsx)("div",{className:"row",children:(0,l.jsx)("div",{className:"col col--6 col--offset-3",children:(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("div",{className:"card__header",children:(0,l.jsx)("h2",{style:{color:"#dc2626"},children:"Access Denied"})}),(0,l.jsxs)("div",{className:"card__body",children:[(0,l.jsx)("p",{children:"You must be logged in to view this page."}),(0,l.jsxs)("div",{style:{marginTop:"20px"},children:[(0,l.jsx)("a",{className:"button button--primary button--block",href:"/signin",children:"Sign In"}),(0,l.jsxs)("div",{style:{textAlign:"center",marginTop:"10px"},children:["or ",(0,l.jsx)("a",{href:"/signup",children:"Create an Account"})]})]})]})]})})})})});const A=h?Object.keys(h).filter(e=>h[e]?.completed).length:0,R=h?Object.keys(h).length:0;return(0,l.jsx)(r.A,{title:"Profile",description:"Your Physical AI & Humanoid Robotics profile",children:(0,l.jsx)("div",{className:"container margin-vert--lg",children:(0,l.jsx)("div",{className:"row",children:(0,l.jsxs)("div",{className:"col col--8 col--offset-2",children:[(0,l.jsxs)("div",{className:"card margin-bottom--lg shadow--md",children:[(0,l.jsx)("div",{className:"card__header",style:{background:"linear-gradient(135deg, #7e22ce 0%, #c026d5 100%)",color:"white"},children:(0,l.jsx)("h2",{style:{margin:0},children:"\ud83d\udc64 Your Profile"})}),(0,l.jsx)("div",{className:"card__body",children:u?(0,l.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),f(!0),v(null),_(!1);try{await c(k.first_name,k.last_name)?(b(!1),_(!0),setTimeout(()=>_(!1),3e3)):v("Failed to update profile. Please try again.")}catch(s){console.error("Profile update error:",s),v(s instanceof Error?s.message:"An error occurred while updating your profile")}finally{f(!1)}},children:[y&&(0,l.jsx)("div",{style:{padding:"10px",marginBottom:"15px",backgroundColor:"#fee2e2",color:"#991b1b",borderRadius:"6px",border:"1px solid #fecaca"},children:y}),N&&(0,l.jsx)("div",{style:{padding:"10px",marginBottom:"15px",backgroundColor:"#dcfce7",color:"#166534",borderRadius:"6px",border:"1px solid #bbf7d0"},children:"\u2705 Profile updated successfully!"}),(0,l.jsxs)("div",{className:"margin-bottom--md",children:[(0,l.jsx)("label",{htmlFor:"first_name",style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"First Name:"}),(0,l.jsx)("input",{type:"text",id:"first_name",name:"first_name",value:k.first_name,onChange:P,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"1em"}})]}),(0,l.jsxs)("div",{className:"margin-bottom--md",children:[(0,l.jsx)("label",{htmlFor:"last_name",style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Last Name:"}),(0,l.jsx)("input",{type:"text",id:"last_name",name:"last_name",value:k.last_name,onChange:P,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"1em"}})]}),(0,l.jsxs)("div",{className:"margin-bottom--md",children:[(0,l.jsx)("strong",{style:{color:"#7e22ce"},children:"Email:"}),(0,l.jsxs)("div",{style:{fontSize:"1em",padding:"8px",backgroundColor:"#f5f5f5",borderRadius:"6px",marginTop:"5px"},children:[e?.email," (cannot be changed)"]})]}),(0,l.jsxs)("div",{className:"button-group button-group--block",children:[(0,l.jsx)("button",{type:"submit",className:"button button--primary",disabled:j,children:j?"Saving...":"Save Changes"}),(0,l.jsx)("button",{type:"button",className:"button button--secondary margin-left--sm",onClick:()=>{b(!1),v(null),e&&w({first_name:e.first_name||"",last_name:e.last_name||""})},disabled:j,children:"Cancel"})]})]}):(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"row",children:[(0,l.jsxs)("div",{className:"col col--6",children:[(0,l.jsxs)("div",{className:"margin-bottom--md",children:[(0,l.jsx)("strong",{style:{color:"#7e22ce"},children:"First Name:"}),(0,l.jsx)("div",{style:{fontSize:"1.2em"},children:e?.first_name||"Not provided"})]}),(0,l.jsxs)("div",{className:"margin-bottom--md",children:[(0,l.jsx)("strong",{style:{color:"#7e22ce"},children:"Last Name:"}),(0,l.jsx)("div",{style:{fontSize:"1.2em"},children:e?.last_name||"Not provided"})]})]}),(0,l.jsxs)("div",{className:"col col--6",children:[(0,l.jsxs)("div",{className:"margin-bottom--md",children:[(0,l.jsx)("strong",{style:{color:"#7e22ce"},children:"Email:"}),(0,l.jsx)("div",{style:{fontSize:"1.2em"},children:e?.email})]}),(0,l.jsxs)("div",{className:"margin-bottom--md",children:[(0,l.jsx)("strong",{style:{color:"#7e22ce"},children:"Member since:"}),(0,l.jsx)("div",{children:e?.created_at?new Date(e.created_at).toLocaleDateString():"Recent"})]})]})]})})}),(0,l.jsx)("div",{className:"card__footer",children:(0,l.jsxs)("div",{className:"button-group button-group--block",children:[!u&&(0,l.jsx)("button",{className:"button button--primary",onClick:()=>b(!0),children:"\u270f\ufe0f Edit Profile"}),(0,l.jsx)("button",{className:"button button--secondary",onClick:()=>m.push("/"),children:"Go Home"}),(0,l.jsx)("button",{className:"button button--danger margin-left--sm",onClick:()=>{t(),m.push("/")},children:"Sign Out"})]})})]}),(0,l.jsxs)("div",{className:"card margin-bottom--lg shadow--md",children:[(0,l.jsx)("div",{className:"card__header",children:(0,l.jsx)("h3",{children:"\ud83d\udcda Reading Progress"})}),(0,l.jsx)("div",{className:"card__body",children:p?(0,l.jsx)("p",{children:"Syncing progress..."}):R>0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"margin-bottom--md",children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[(0,l.jsx)("strong",{children:"Completion Status"}),(0,l.jsxs)("span",{children:[A," / ",R," Chapters"]})]}),(0,l.jsx)("div",{style:{width:"100%",height:"10px",background:"#e5e7eb",borderRadius:"5px",overflow:"hidden"},children:(0,l.jsx)("div",{style:{width:A/R*100+"%",height:"100%",background:"#10b981",transition:"width 0.5s ease"}})})]}),(0,l.jsxs)("div",{className:"margin-bottom--md",children:[(0,l.jsx)("strong",{children:"Details:"}),(0,l.jsx)("ul",{style:{marginTop:"10px",listStyle:"none",padding:0},children:Object.entries(h).map(([e,s])=>(0,l.jsxs)("li",{style:{padding:"10px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsxs)("span",{children:["\ud83d\udcc4 ",(0,l.jsx)("strong",{children:e})]}),(0,l.jsxs)("span",{children:[s.completed?(0,l.jsx)("span",{className:"badge badge--success",children:"\u2705 Completed"}):(0,l.jsx)("span",{className:"badge badge--secondary",children:"\ud83d\udcd6 In Progress"}),(0,l.jsxs)("span",{style:{marginLeft:"10px",fontSize:"0.85em",color:"#666"},children:["(",Math.floor((s.time_spent||0)/60)," ","min read)"]})]})]},e))})]})]}):(0,l.jsxs)("div",{style:{textAlign:"center",padding:"20px",backgroundColor:"#f9fafb",borderRadius:"8px"},children:[(0,l.jsx)("p",{children:"No reading progress recorded yet."}),(0,l.jsx)("a",{href:"/docs/intro",className:"button button--primary button--sm",children:"Start Reading"})]})})]})]})})})})}}}]);